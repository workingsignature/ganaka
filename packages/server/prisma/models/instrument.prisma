model Instrument {
    id         String      @id @default(uuid())
    includedIn Shortlist[]

    exchange              String
    exchangeToken         String
    tradingSymbol         String
    growwSymbol           String @unique
    name                  String
    internalTradingSymbol String

    broadSector   InstrumentBroadSector   @relation(fields: [broadSectorName], references: [name], onDelete: Cascade)
    sector        InstrumentSector        @relation(fields: [sectorName], references: [name], onDelete: Cascade)
    broadIndustry InstrumentBroadIndustry @relation(fields: [broadIndustryName], references: [name], onDelete: Cascade)
    industry      InstrumentIndustry      @relation(fields: [industryName], references: [name], onDelete: Cascade)

    broadSectorName   String
    sectorName        String
    broadIndustryName String
    industryName      String
    createdAt         DateTime @default(now())
    updatedAt         DateTime @updatedAt

    @@index([tradingSymbol, growwSymbol, name, broadSectorName, sectorName, broadIndustryName, industryName])
}

model InstrumentBroadSector {
    id String @id @default(uuid())

    name        String             @unique
    instruments Instrument[]
    sectors     InstrumentSector[]

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@index([name])
}

model InstrumentSector {
    id String @id @default(uuid())

    name            String                    @unique
    instruments     Instrument[]
    broadSector     InstrumentBroadSector     @relation(fields: [broadSectorName], references: [name], onDelete: Cascade)
    broadIndustries InstrumentBroadIndustry[]

    broadSectorName String
    createdAt       DateTime @default(now())
    updatedAt       DateTime @updatedAt

    @@index([name, broadSectorName])
}

model InstrumentBroadIndustry {
    id String @id @default(uuid())

    name        String               @unique
    instruments Instrument[]
    sector      InstrumentSector?    @relation(fields: [sectorName], references: [name], onDelete: Cascade)
    industries  InstrumentIndustry[]

    sectorName String?
    createdAt  DateTime @default(now())
    updatedAt  DateTime @updatedAt

    @@index([name])
}

model InstrumentIndustry {
    id String @id @default(uuid())

    name          String                  @unique
    instruments   Instrument[]
    broadIndustry InstrumentBroadIndustry @relation(fields: [broadIndustryName], references: [name], onDelete: Cascade)

    broadIndustryName String
    createdAt         DateTime @default(now())
    updatedAt         DateTime @updatedAt

    @@index([name, broadIndustryName])
}
